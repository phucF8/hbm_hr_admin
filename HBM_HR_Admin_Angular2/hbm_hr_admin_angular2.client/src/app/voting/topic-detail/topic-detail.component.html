<form [formGroup]="myForm" (ngSubmit)="onSubmit()" class="needs-validation">
  <div class="container_popup">
    <div class="header">CHI TI·∫æT CH·ª¶ ƒê·ªÄ
      <button type="button" class="btn-close-circle" aria-label="ƒê√≥ng" mat-dialog-close (click)="closePopup()">
        √ó
      </button>
    </div>

    <!-- TH√îNG TIN NG∆Ø·ªúI D√ôNG -->
    <div class="section">
      <div class="section-title">NG∆Ø·ªúI T·∫†O</div>

      <div class="info-row">
        <div class="info-label">‚Ä∫ Username</div>
        <div class="info-value">{{ data.createdByName }}</div>
      </div>

      <div class="info-row">
        <div class="info-label">‚Ä∫ Ng∆∞·ªùi c·∫≠p nh·∫≠t cu·ªëi</div>
        <div class="info-value">{{ data.updatedByName || 'Ch∆∞a c·∫≠p nh·∫≠t' }}</div>
      </div>
    </div>

    <!-- TH√îNG TIN API -->
    <div class="section">
      <div class="section-title">TH√îNG TIN CH·ª¶ ƒê·ªÄ</div>

      <div class="info-row">
        <div class="info-label">‚Ä∫ ID</div>
        <div class="info-value">{{ data.id }}</div>
      </div>

      <!-- <app-text-input formControlName="title" label="Ti√™u ƒë·ªÅ" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ" /> -->

      <!-- Truy·ªÅn FormControl tr·ª±c ti·∫øp -->
      <app-text-input label="Ti√™u ƒë·ªÅ" [control]="getFormControl('title')"></app-text-input>

      <app-area-input label="M√¥ t·∫£" placeholder="Nh·∫≠p n·ªôi dung m√¥ t·∫£" [control]="getFormControl('description')" />

      <div class="row">
        <div class="col">
          <app-date-input label="Ng√†y b·∫Øt ƒë·∫ßu" placeholder="Nh·∫≠p ng√†y b·∫Øt ƒë·∫ßu"
            [control]="getFormControl('startDate')" />
        </div>
        <div class="col">
          <app-date-input label="Ng√†y k·∫øt th√∫c" placeholder="Nh·∫≠p ng√†y k·∫øt th√∫c"
            [control]="getFormControl('endDate')" />
        </div>
      </div>
    </div>

    <!--Them HTML de hien thi danh sach cau hoi cua topic nay, moi cau hoi la 1 input de user co the sua noi dung cau hoi
        Ben canh la select de chon loai cho cau hoi, co 3 loai Chon 1, Chon nhieu, va Tu luan
        
    -->

    <div class="d-flex justify-content-between align-items-center mt-4 mb-2">
      <h5>Danh s√°ch c√¢u h·ªèi</h5>
      <button type="button" class="btn btn-outline-primary btn-sm" (click)="addQuestion()">
        + Th√™m c√¢u h·ªèi
      </button>
    </div>







    






















    
    <!-- Danh s√°ch c√¢u h·ªèi -->
    <div formArrayName="questions" class="questions-container">
      <div *ngFor="let q of questionsFormArray.controls; let i = index" [formGroupName]="i" class="question-card">

        <!-- Header -->
        <div class="question-header d-flex align-items-center justify-content-between">
          <div class="cauhoi d-flex align-items-center gap-2">
            <div class="badge bg-primary text-white px-3 py-1 rounded-pill">
              
            </div>
            <input formControlName="content" class="form-control border-0 fs-6 fw-semibold"
              placeholder="N·ªôi dung c√¢u h·ªèi" />
          </div>

          <!-- Lo·∫°i c√¢u h·ªèi & xo√° -->
          <div class="d-flex align-items-center gap-2">
            <select class="question-type-select" formControlName="type">
              <option value="SingleChoice">Ch·ªçn m·ªôt</option>
              <option value="MultiChoice">Ch·ªçn nhi·ªÅu</option>
              <option value="Essay">T·ª± lu·∫≠n</option>
            </select>
            <div style="width: 8px; display: inline-block;"></div>
            <button type="button" class="btn-vuong btn-outline-danger btn-sm" (click)="removeQuestion(i)">üóë</button>
          </div>
        </div>

        <!-- Option n·∫øu kh√¥ng ph·∫£i Essay -->
        <div *ngIf="q.get('type')?.value !== 'Essay'" formArrayName="options" class="options-container">
          <button type="button" class="add-option-btn" (click)="addOption(i)">+Th√™m l·ª±a
            ch·ªçn</button>
          <div *ngFor="let opt of getOptionsFormArray(i).controls; let j = index" [formGroupName]="j"
            class="option-item d-flex align-items-center gap-2 mb-2">
            <input class="form-control" formControlName="content" placeholder="N·ªôi dung ph∆∞∆°ng √°n" />
            <button type="button" class="btn btn-outline-danger btn-sm" (click)="removeOption(i, j)">üóë</button>
          </div>
          
        </div>

        
      </div>
    </div>





    <!-- TH√îNG TIN THI·∫æT B·ªä (T√ôY CH·ªåN) -->
    <div class="section">
      <div class="section-title">TH√îNG TIN H·ªÜ TH·ªêNG</div>

      <div class="info-row">
        <div class="info-label">‚Ä∫ Ng√†y t·∫°o</div>
        <div class="info-value">{{ data.createdAt | date: 'dd/MM/yyyy HH:mm' }}</div>
      </div>

      <div class="info-row">
        <div class="info-label">‚Ä∫ C·∫≠p nh·∫≠t l√∫c</div>
        <div class="info-value">{{ data.updatedAt ? (data.updatedAt | date: 'dd/MM/yyyy HH:mm') : 'Ch∆∞a c·∫≠p nh·∫≠t' }}
        </div>
      </div>

    </div>

    <!-- N√∫t ƒë√≥ng -->
    <div class="button-group">
      <button type="button" class="btn btn-cancel" mat-dialog-close (click)="onSubmit()">
        C·∫¨P NH·∫¨T
      </button>
    </div>
  </div>
</form>