<div style="padding-left: 48px; padding-right: 48px;">
  <div class="tabs">
    <div class="tab active">Quản lý Ý kiến Góp ý</div>
  </div>

  <div class="search-container">
    <div class="search-title">TIÊU CHÍ TÌM KIẾM</div>

    <div class="search-form" style="display: flex; align-items: center; justify-content: space-between;">
      <div>
        <div style="display: flex; gap: 10px; margin-bottom: 16px; flex-wrap: wrap;">
          
          <div class="form-group">
            <label>Tiêu đề hoặc nội dung</label>
            <input type="text" class="form-control" placeholder="Tìm kiếm..." [(ngModel)]="searchText"
              (input)="applyFilters()">
          </div>

          <!-- <div class="form-group">
            <label>Loại ý kiến</label>
            <select class="dropdown" [(ngModel)]="selectedType" (change)="applyFilters()">
              <option value="">Tất cả loại</option>
              <option value="Góp ý">Góp ý</option>
              <option value="Báo lỗi">Báo lỗi</option>
              <option value="Đề xuất tính năng">Đề xuất tính năng</option>
              <option value="Khiếu nại">Khiếu nại</option>
            </select>
          </div> -->

          <div class="form-group">
            <label>Trạng thái</label>
            <select class="dropdown" [(ngModel)]="selectedStatus" (change)="applyFilters()">
              <option value="">Tất cả</option>
              <option value="GY_CD">Chưa đọc</option>
              <option value="GY_DD">Đã đọc</option>
            </select>
          </div>

          <!-- <div class="form-group">
            <label>Từ ngày</label>
            <input type="date" class="form-control-date" [(ngModel)]="startDate" (change)="applyFilters()">
          </div>
          <div class="form-group">
            <label>Đến ngày</label>
            <input type="date" class="form-control-date" [(ngModel)]="endDate" (change)="applyFilters()">
          </div> -->
        </div>
      </div>

      <div class="buttons-container">
        <button class="btn btn-search" (click)="applyFilters()">
          <i class="bi bi-search"></i> Tìm kiếm
        </button>
        <!-- <div class="right-buttons">
          <button class="btn btn-clear" (click)="clearFilters()" style="background-color: #f15a59;">
            <i class="bi bi-x-circle"></i> Xóa bộ lọc
          </button>
        </div> -->
      </div>
    </div>
  </div>

  <div class="panel"
    style="margin-top: 20px; background: white; border-radius: 5px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
    <div class="panel-header"
      style="padding: 12px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between;">
      <div><strong>DANH SÁCH BẢN GHI</strong></div>
      <span class="result-count">Hiển thị {{ filteredFeedbacks.length }} ý kiến</span>
    </div>

    <table class="my-table">
      <thead>
        <tr>
          <th style="width: 4%; text-align: center;">#</th>
          <th style="width: 18%;">Tiêu đề</th>
          <th style="width: 35%;">Nội dung</th>
          <th style="width: 12%;">Người gửi</th>
          <th style="width: 12%;">Người nhận</th>
          <th style="width: 9%; text-align: center;">Ngày gửi</th>
          <th style="width: 10%; text-align: center;">Trạng thái</th>
          <th style="text-align: center; white-space: nowrap;">Hành động</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let feedback of filteredFeedbacks; let i = index">
          <td>{{ utils.calculateTableIndex(i,queryParams.pageNumber,queryParams.pageSize) }}</td>
          <td style="text-align: left;">{{ feedback.tieuDe }}</td>
          <td style="text-align: left;">{{ feedback.noiDung }}</td>
          <td>{{ feedback.tenNguoiGui }}</td>
          <td>{{ feedback.tenNguoiNhan }}</td>
          <!-- <td>{{ feedback.anDanh }}</td> -->
          <td>{{ feedback.ngayGui | date: 'dd/MM/yyyy' }}</td>
          <td>
            <span class="status-badge status-{{ feedback.trangThai }}">
              {{ getStatusLabel(feedback.trangThai) }}
            </span>
          </td>
          <td>
            <div class="dropdown-wrapper" (click)="toggleMenu(feedback); $event.stopPropagation()">
              <div class="dropdown-button" style="background-color: #6c63ff;">
                <div class="arrow-down"></div>
              </div>
              <div class="popup-menu" *ngIf="openedMenuId === feedback.id" style="right: 0;">
                <div class="menu-item view" (click)="viewFeedback(feedback.id)">
                  <i class="bi bi-eye"></i>
                  <div class="menu-text">Xem</div>
                </div>
                <div class="menu-item edit" (click)="editFeedback(feedback.id)">
                  <i class="bi bi-pencil"></i>
                  <div class="menu-text">Sửa</div>
                </div>
                <div class="menu-item delete" (click)="deleteFeedback(feedback.id)">
                  <i class="bi bi-trash"></i>
                  <div class="menu-text">Xóa</div>
                </div>
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="filteredFeedbacks.length === 0" class="no-results" style="padding: 40px; text-align: center;">
      <p>Không tìm thấy ý kiến nào phù hợp.</p>
    </div>
  </div>

  <!-- Pagination section -->
      <app-pagination [totalPages]="totalPage" [currentPage]="this.queryParams.pageNumber" (pageChange)="onPageChange($event)">
      </app-pagination>

</div>